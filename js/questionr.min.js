!function(t,e){var n,o,r,s,a,u,p=t[e],l=!1;if(void 0===typeof window.jQuery)throw"jQuery was not found";try{l=void 0!==typeof window.sessionStorage}catch(c){}s={showClose:!0},p||(a={show:[],start:[],changeStep:[],end:[],hide:[]},o={skipBtn:"Skip",doneBtn:"Done",closeTooltip:"Close",selectText:"Please choose"},r={},u={getI18NString:function(t){return r[t]||o[t]},invokeCallbackArray:function(t){if($.isArray(t))for(i=0,len=t.length;len>i;++i)u.invokeCallback(t[i])},invokeCallback:function(t){return"function"==typeof t?t():"object"==typeof t?u.invokeCallbackArray(t):void 0},invokeEventCallbacks:function(t){var e,n,i=a[t];for(e=0,n=i.length;n>e;++e)this.invokeCallback(i[e].cb)},valOrDefault:function(t,e){return"undefined"!=typeof t?t:e},unserialize:function(t){if(!t||void 0===t)return{};for(var e,n={},i=t.replace(/^\?/,"").split("&"),o=i.length,r=0;o>r;r++)i[r]&&(e=i[r].split("="),n[e[0]]=e[1]);return n}},QuestionrBoard=function(t){this.init(t)},QuestionrBoard.prototype={_form:function(){var t=$('<form class="form"></form>').on("submit",function(t){t.preventDefault()});return t},_closeBtn:function(){var t=this,e=$('<a href="#" class="close-action" title="'+u.getI18NString("closeTooltip")+'">'+u.getI18NString("closeTooltip")+"</a>");return e.on("click",function(e){e.preventDefault(),t.hide(!0)}),e},_actBtn:function(t){var e=t.onDone,n=this,i=$('<button type="submit" class="done">'+u.valOrDefault(t.actBtn,u.getI18NString("doneBtn"))+"</button>").on("click",function(t){t.preventDefault(),n._updateAnswers();var i=questionr.getCurrStepNum()+1;try{questionr.jumpToStep(i)}catch(o){questionr.end()}"function"==typeof e&&e()});return i},_skipBtn:function(t){var e=t.onSkip,n=$('<button type="button" class="skip">'+u.valOrDefault(t.skipBtn,u.getI18NString("skipBtn"))+"</button>");return"function"==typeof e&&n.on("click",function(){e()}),n},_extraBtn:function(t){var e=t.onExtra,n=$('<button type="button" class="'+u.valOrDefault(t.extraBtnStyle,"skip")+'">'+u.valOrDefault(t.extraBtn,u.getI18NString("extraBtn"))+"</button>");return"function"==typeof e&&n.on("click",function(){e()}),n},_inputOptions:function(t,e){if(/radio|checkbox/.test(t)){var n,i,o=$("<ul></ul>"),r=e.required!==!1?"required":"";for(n=0,i=e.options.length;i>n;n++){var s=e.options[n],a=$('<li><label><input name="'+e.name+'" type="'+t+'" value="'+s.value+'" '+r+"> "+(s.title||s.value)+"</label></li>");"string"==typeof s.hint&&a.append(this._hint(s.hint)),o.append(a)}return o}},_textarea:function(t){var e=t.required!==!1?"required":"",n=$('<fieldset><textarea name="'+t.name+'" '+e+"></textarea></fieldset>");return"string"==typeof t.hint&&n.append(this._hint(t.hint)),n},_text:function(t){var e=t.required!==!1?"required":"",n=$('<fieldset><input name="'+t.name+'" type="text" '+e+"></fieldset>");return"string"==typeof t.hint&&n.append(this._hint(t.hint)),n},_checkbox:function(t){return this._inputOptions("checkbox",t)},_radio:function(t){return this._inputOptions("radio",t)},_select:function(t){var e,n,i=t.required!==!1?"required":"",o=t.required===!1?'<option value="">'+u.getI18NString("selectText")+"</option>":"",r=$('<select name="'+t.name+'" '+i+">"+o+"</select>"),s=$("<fieldset></fieldset>");for(e=0,n=t.options.length;n>e;e++){var a=t.options[e],p=$('<option value="'+a.value+'">'+(a.title||a.value)+"</option>");r.append(p)}return s.append(r),"string"==typeof t.hint&&s.append(this._hint(t.hint)),s},_hint:function(t){return $('<span class="info" title="'+t+'"><span class="icon-info"><span>?</span></span></span>')},_component:function(t){var e,n=$('<div class="fieldgroup"></div>');void 0!==t.title&&n.append("<p>"+t.title+"</p>");var i={textarea:"_textarea",text:"_text",checkbox:"_checkbox",radio:"_radio",select:"_select"},o="function"==typeof this[i[t.type]]?this[i[t.type]]:null;if(!o)throw'Input type "'+t.type+'" was not found';return e=o.call(this,t),n.append(e),n},_renderComponents:function(t){if("object"==typeof t&&!$.isArray(t))return this._component(t);var e,n,i;for(e=0,n=t.length;n>e;e++)i?i.append(this._component(t[e])):i=this._component(t[e]);return i},_updateAnswers:function(){var t=el.find("form");questionr.setData(t.serializeArray())},init:function(t){var e="object"==typeof t.target?t.target:$(t.target);if(!e.length)throw"Target element was not found";el=$('<div class="questionr board"><div class="questionr-container"></div></div>'),getOption("showClose")===!0&&el.prepend(this._closeBtn()),e.append(el)},render:function(t,e){var n=el.find("> .questionr-container").first(),i=$('<div class="questionr-step" data-step-id="'+e+'"></div>'),o=this._form(),r=$('<div class="actions-wrapper"></div>');if(void 0!==t.title&&o.append($('<span class="title">'+t.title+"</span>")),void 0!==t.description&&o.append($('<span class="description">'+t.description+"</span>")),void 0!==t.form){var s=this._renderComponents.call(this,t.form);o.append(s)}t.showDone!==!1&&r.append(this._actBtn(t)),t.showSkip===!0&&r.append(this._skipBtn(t)),t.showSkip===!0&&r.append(this._extraBtn(t)),o.append(r),i.append(o),n.html(i),questionr.setCurrStep(e),"function"==typeof t.onShow&&t.onShow()},show:function(){el.fadeIn(200),u.invokeEventCallbacks("show")},hide:function(t){var e=this;el.fadeOut(200,function(){t&&e.destroy()}),u.invokeEventCallbacks("hide")},destroy:function(){el.remove()}},n=function(){var t,e,n,i,o,p=[];getBoard=function(){return n||(n=new QuestionrBoard(i)),n},getOption=function(t){return void 0===typeof i?s[t]:u.valOrDefault(i[t],s[t])},loadQuestionnaire=function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&"id"!==e&&"steps"!==e&&(n[e]=t[e]);return o.call(this,n),this},this.start=function(e,n){var i,o;if(t||(t=e,loadQuestionnaire.call(this,e)),"function"==typeof n&&this.listen("end",n),u.invokeEventCallbacks("start"),i=getBoard(),void 0===t.steps[0])throw"Step was not found";return o=t.steps[0],i.render(o,0),i.show(),this},this.end=function(t){return u.invokeEventCallbacks("end"),t!==!1&&n.hide(!0),this},this.jumpToStep=function(e){var i=t.steps[e];if(void 0===i)throw"Step was not found";return n.render(i,e),u.invokeEventCallbacks("changeStep"),this},this.getAnswer=function(t){var e=u.unserialize(this.getData());return u.valOrDefault(e[t],!1)},this.getCurrQuestionnaire=function(){return t},this.getCurrStep=function(){return this.getStep(e)},this.setCurrStep=function(t){return e=t,this},this.getCurrStepNum=function(){return e},this.getStep=function(e){if(void 0===e)throw"Enter the step number param";var n=t.steps[e];if(void 0===n)throw"Step was not found";return n},this.getNextStep=function(){try{return this.getStep(e+1)}catch(t){throw"No have next step, it's finished"}},this.setData=function(t){var e=p;return p=$.merge(t,e),this},this.getData=function(t){return t?p:"undefined"==typeof p?!1:$.param(p)},this.listen=function(t,e){return t&&a[t].push({cb:e}),this},this.unlisten=function(t,e){var n,i,o=a[t];for(n=0,i=o.length;i>n;++n)o[n]===e&&o.splice(n,1);return this},this.resetDefaultOptions=function(){return i={},this},o=function(t){var e,n=["start","show","changeStep","end","hide"];for(i||this.resetDefaultOptions(),$.extend(i,t),t&&$.extend(r,t.i18n),e=0,len=n.length;len>e;++e)eventPropName="on"+n[e].charAt(0).toUpperCase()+n[e].substring(1),t[eventPropName]&&this.listen(n[e],t[eventPropName]);return this},this.configure=function(t){return o.call(this,t)}},p=new n,t[e]=p)}(window,"questionr");